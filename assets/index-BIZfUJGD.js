(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(t){if(t.ep)return;t.ep=!0;const n=o(t);fetch(t.href,n)}})();const p="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2FzeW5jIGZ1bmN0aW9uIGcocyxvKXtjb25zdHt0eXBlOmN9PXMsbj1hd2FpdCBjcmVhdGVJbWFnZUJpdG1hcChzKTtsZXR7d2lkdGg6ZSxoZWlnaHQ6dH09bix7cXVhbGl0eTpsPS44LGxlblNpemVMaW1pdDpyPTgxOTIsZmlsZVNpemVMaW1pdDp1PTMwLHVzZVdlYnA6dz0hMH09b3x8e307Y29uc3QgeD13PyJpbWFnZS93ZWJwIjpjLG09dTw8MjAsZj1lKnQsTT1NYXRoLm1pbihyLDMyNzY3KTtsZXQgYT0xOyhmPjI2ODQzNTQ1Nnx8ZT5yfHx0PnIpJiYoYT1NYXRoLm1pbihNYXRoLnNxcnQoMjY4NDM1NDU2L2YpLE0vZSxNL3QpLGU9TWF0aC5mbG9vcihlKmEpLHQ9TWF0aC5mbG9vcih0KmEpKTtjb25zdCBoPW5ldyBPZmZzY3JlZW5DYW52YXMoZSx0KSxwPWguZ2V0Q29udGV4dCgiMmQiKTtwLnNjYWxlKGEsYSkscC5kcmF3SW1hZ2UobiwwLDApO2xldCBpO2RvIGk9YXdhaXQgaC5jb252ZXJ0VG9CbG9iKHt0eXBlOngscXVhbGl0eTpsfSksbCo9bS9pLnNpemUtLjE7d2hpbGUoaS5zaXplPm0mJmw+LjEpO3JldHVybiBpfXNlbGYub25tZXNzYWdlPXM9Pntjb25zdFtvLGNdPXMuZGF0YTtnKG8sYykudGhlbihuPT57c2VsZi5wb3N0TWVzc2FnZShuKX0pfX0pKCk7Cg==",h=r=>Uint8Array.from(atob(r),e=>e.charCodeAt(0)),d=typeof self<"u"&&self.Blob&&new Blob([h(p)],{type:"text/javascript;charset=utf-8"});function L(r){let e;try{if(e=d&&(self.URL||self.webkitURL).createObjectURL(d),!e)throw"";const o=new Worker(e,{name:r==null?void 0:r.name});return o.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(e)}),o}catch{return new Worker("data:text/javascript;base64,"+p,{name:r==null?void 0:r.name})}finally{e&&(self.URL||self.webkitURL).revokeObjectURL(e)}}async function y(r,e){const o=new Array;for(const s of r){const t=new Promise(async(n,i)=>{if(!s.type.startsWith("image/"))throw new Error("只支持图片压缩");const{fileSizeLimit:b=30}={};if(s.size<=b<<20){n(s);return}const l=new L;l.onmessage=a=>{n(a.data),l.terminate()},l.onerror=a=>{i(a),l.terminate()},l.postMessage([s,e])});o.push(t)}return Promise.all(o)}const c=document.createElement("input");c.type="file";c.accept="image/*";c.multiple=!0;document.body.appendChild(c);const f=document.createElement("div");document.body.appendChild(f);c.onchange=async()=>{try{if(console.time("compress"),!c.files)return;const r=await y(c.files);console.timeEnd("compress"),document.body.append("压缩成功");for(let e=0;e<r.length;e++){const o=r[e],s=URL.createObjectURL(o),t=document.createElement("a");t.href=s,t.download=`compressed-${e}.webp`,t.textContent=`下载-${e+1}`,f.appendChild(t)}}catch(r){console.error("压缩失败",r)}};let m=new Date().getTime();const u=()=>{const r=new Date().getTime(),e=r-m;e>1e3&&console.log("time:",e),m=r,requestAnimationFrame(u)};u();
